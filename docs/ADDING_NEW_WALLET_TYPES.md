# Guide to Adding a New Wallet Type in Cake Wallet

## Important: EVM-Compatible Wallets

**If you're adding an EVM-compatible wallet (Ethereum, Polygon, Base, Arbitrum, Optimism, etc.)**, please refer to the **[Adding New L2 Network Guide](./adding_new_l2_network_guide.md)** instead. EVM wallets use a unified architecture and don't require the full setup described in this guide.

**For EVM wallets:**
- Use `WalletType.evm` (unified type for all EVM chains)
- Add chain configuration to `EvmChainRegistry`
- No proxy files needed (unified `evm` proxy handles all chains)
- See the L2 guide for detailed steps

---

## Wallet Integration Overview

**Note**: Throughout this guide, `walletx` refers to the specific wallet type you want to add. If you're adding `BNB` to CakeWallet, then `walletx` for you here is `bnb`.

This guide covers adding **non-EVM** wallet types. The process involves:
1. Core package setup (`cw_walletx`)
2. Proxy setup (communication layer)
3. Configuration files
4. Dependency injection
5. Node setup
6. UI integration
7. Feature integration (send, receive, exchange, etc.)

---

## Step 1: Core Package Setup

### 1.1 Add WalletType Enum

**File**: `cw_core/lib/wallet_type.dart`

Add your new wallet type to the enum:

```dart
enum WalletType {
  // ... existing types ...
  @HiveField(19) // Use next available field ID
  walletx,
}
```

**Update Required Functions**:
- `serializeToInt()`: Add `case WalletType.walletx: return 19;`
- `deserializeFromInt()`: Add `case 19: return WalletType.walletx;`
- `walletTypeToString()`: Add `case WalletType.walletx: return 'WalletX';`
- `walletTypeToDisplayName()`: Add `case WalletType.walletx: return 'WalletX';`

### 1.2 Add Currency Mapping

**File**: `cw_core/lib/currency_for_wallet_type.dart`

Add a case in the `currencyForWalletType` function:

```dart
CryptoCurrency currencyForWalletType(WalletType type) {
  switch (type) {
    // ... existing cases ...
    case WalletType.walletx:
      return CryptoCurrency.walletx; // Must exist in crypto_currency.dart
  }
}
```

### 1.3 Add Native Currency (If New)

**File**: `cw_core/lib/crypto_currency.dart`

If the cryptocurrency doesn't exist, add it:

```dart
static const CryptoCurrency walletx = CryptoCurrency(
  name: 'WalletX',
  title: 'WLTX',
  raw: 'walletx',
  iconPath: 'assets/images/walletx.png', // Add icon asset
  tag: 'WLTX', // Optional tag for identification
);
```

**Important**: Add the currency to the `all` list in the same file:

```dart
static List<CryptoCurrency> get all => [
  // ... existing currencies ...
  walletx,
];
```

### 1.4 Create Core Package

Create a new package for wallet-specific integration: `cw_walletx/`

**Required Files** (create as needed):
- `walletx_transaction_history.dart` - Transaction history management
- `walletx_transaction_info.dart` - Transaction information model
- `walletx_mnemonics_exception.dart` - Mnemonic-related exceptions
- `walletx_tokens.dart` - Token management (if applicable)
- `walletx_wallet_service.dart` - Wallet service implementation
- `walletx_wallet.dart` - Main wallet class
- `walletx_client.dart` - Network client (if applicable)
- `walletx_new_wallet_credentials.dart` - New wallet credentials
- `walletx_restore_wallet_credentials.dart` - Restore wallet credentials
- etc.

### 1.5 Add Code Generation

**File**: `model_generator.sh`

Add code generation for your package:

```bash
cd cw_walletx && flutter pub get && dart run build_runner build --delete-conflicting-outputs && cd ..
```

**Add dev_dependencies** to `cw_walletx/pubspec.yaml`:
```yaml
dev_dependencies:
  build_runner: ^2.0.0
  mobx_codegen: ^2.0.0
  hive_generator: ^2.0.0
```

---

## Step 2: Proxy Setup

A **Proxy** class is used to communicate with the wallet package. Instead of directly importing from `cw_walletx` within the `lib` directory, we use a proxy to access these functionalities. This maintains separation of concerns and allows conditional compilation.

### 2.1 Create Proxy Directory

Create a proxy folder: `lib/walletx/`

It should contain 2 files:
- `cw_walletx.dart` - Implementation class (links `cw_walletx` package to `lib`)
- `walletx.dart` - Abstract class (generated, defines the interface)

### 2.2 Add to .gitignore

**File**: `.gitignore`

Add the generated abstract class file:

```
lib/walletx/walletx.dart
```

**Note**: The `walletx.dart` file is generated by `configure.dart` and should not be committed.

### 2.3 Create Implementation File

**File**: `lib/walletx/cw_walletx.dart`

Create the implementation class:

```dart
part of 'walletx.dart';

class CWWalletX extends WalletX {
  @override
  List<String> getWalletXWordList(String language) => WalletXMnemonics.englishWordlist;

  @override
  WalletService createWalletXWalletService(bool isDirect) =>
      WalletXWalletService(isDirect);

  @override
  WalletCredentials createWalletXNewWalletCredentials({
    required String name,
    String? mnemonic,
    WalletInfo? walletInfo,
    String? password,
    String? passphrase,
  }) =>
      WalletXNewWalletCredentials(
        name: name,
        walletInfo: walletInfo,
        password: password,
        mnemonic: mnemonic,
        passphrase: passphrase,
      );

  // Add other required methods from the abstract class
}
```

---

## Step 3: Configuration Files Setup

### 3.1 Update configure.dart

**File**: `tool/configure.dart`

#### 3.1.1 Add Output Path Constant

```dart
const walletxOutputPath = 'lib/walletx/walletx.dart';
```

#### 3.1.2 Add Activation Variable

In the `main()` function:

```dart
final hasWalletX = args.contains('${prefix}walletx');
```

#### 3.1.3 Create Generation Function

Add a function to generate the abstract class:

```dart
Future<void> generateWalletX(bool hasImplementation) async {
  final outputFile = File(walletxOutputPath);
  const walletxCommonHeaders = """
import 'package:cw_core/wallet_base.dart';
import 'package:cw_core/wallet_credentials.dart';
import 'package:cw_core/wallet_info.dart';
import 'package:cw_core/wallet_service.dart';
import 'package:cw_core/crypto_currency.dart';
import 'package:cw_core/transaction_info.dart';
// Add other necessary imports
""";

  const walletxCWHeaders = """
import 'package:cw_walletx/walletx_wallet.dart';
import 'package:cw_walletx/walletx_wallet_service.dart';
import 'package:cw_walletx/walletx_mnemonics.dart';
// Add other necessary imports from cw_walletx
""";

  const walletxCwPart = """
part 'cw_walletx.dart';
""";

  const walletxContent = """
abstract class WalletX {
  List<String> getWalletXWordList(String language);
  WalletService createWalletXWalletService(bool isDirect);
  WalletCredentials createWalletXNewWalletCredentials({
    required String name,
    String? mnemonic,
    WalletInfo? walletInfo,
    String? password,
    String? passphrase,
  });
  // Add other abstract methods as needed
}
""";

  const walletxEmptyDefinition = 'WalletX? walletx;\n';
  const walletxCwDefinition = 'WalletX? walletx = CWWalletX();\n';

  final output = '$walletxCommonHeaders\n' +
      (hasImplementation ? '$walletxCWHeaders\n' : '\n') +
      (hasImplementation ? '$walletxCwPart\n\n' : '\n') +
      (hasImplementation ? walletxCwDefinition : walletxEmptyDefinition) +
      '\n' +
      walletxContent;

  if (outputFile.existsSync()) {
    await outputFile.delete();
  }

  await outputFile.writeAsString(output);
}
```

#### 3.1.4 Call Generation Function

In `main()`, add:

```dart
await generateWalletX(hasWalletX);
```

#### 3.1.5 Update generatePubspec Function

Add parameter and logic:

```dart
Future<void> generatePubspec({
  // ... existing parameters ...
  required bool hasWalletX,
}) async {
  // ... existing code ...
  
  const cwWalletX = """
  cw_walletx:
    path: ./cw_walletx
    """;

  // ... existing code ...
  
  if (hasWalletX) {
    output += '\n$cwWalletX';
  }
}
```

#### 3.1.6 Update generateWalletTypes Function

Add parameter and logic:

```dart
Future<void> generateWalletTypes({
  // ... existing parameters ...
  required bool hasWalletX,
}) async {
  // ... existing code ...
  
  if (hasWalletX) {
    outputContent += '\tWalletType.walletx,\n';
  }
}
```

### 3.2 Update Build Scripts

**Files**: 
- `scripts/android/app_config.sh`
- `scripts/ios/app_config.sh`
- `scripts/macos/app_config.sh`

Add `--walletx` to the `CONFIG_ARGS` under `$CAKEWALLET`:

```bash
CONFIG_ARGS="--monero --bitcoin --walletx"
```

### 3.3 Run Configuration

Open a terminal and run:

```bash
cd scripts/android/
source ./app_env.sh cakewallet
./app_config.sh

cd cw_walletx && flutter pub get && dart run build_runner build --delete-conflicting-outputs && cd ..
dart run build_runner build --delete-conflicting-outputs
```

This will:
- Generate the proxy abstract class
- Add wallet type to available types
- Add `cw_walletx` to `pubspec.yaml`

---

## Step 4: Dependency Injection

### 4.1 Register Wallet Service

**File**: `lib/di.dart`

In the `registerWalletService` function, add your case:

```dart
getIt.registerFactoryParam<WalletService, WalletType, void>((WalletType param1, __) {
  switch (param1) {
    // ... existing cases ...
    case WalletType.walletx:
      return walletx!.createWalletXWalletService(SettingsStoreBase.walletPasswordDirectInput);
  }
});
```

**Note**: Import the proxy at the top of the file:

```dart
import 'package:cake_wallet/walletx/walletx.dart';
```

### 4.2 Register Wallet Creation Credentials

**File**: `lib/view_model/wallet_new_vm.dart`

In the `getCredentials` method, add your case:

```dart
@override
WalletCredentials getCredentials(dynamic _options) {
  // ... existing code ...
  
  switch (type) {
    // ... existing cases ...
    case WalletType.walletx:
      return walletx!.createWalletXNewWalletCredentials(
        name: name,
        password: walletPassword,
        mnemonic: newWalletArguments!.mnemonic,
        passphrase: passphrase,
      );
  }
}
```

**Note**: Import the proxy:

```dart
import 'package:cake_wallet/walletx/walletx.dart';
```

---

## Step 5: Node Setup

### 5.1 Create Node List YAML

**File**: `assets/walletx_node_list.yml`

Create a YAML file with default RPC endpoints:

```yaml
- uri: api.walletx.io
  is_default: true
  useSSL: true
  isEnabledForAutoSwitching: true
- uri: walletx.publicnode.com
  useSSL: true
  isEnabledForAutoSwitching: true
```

### 5.2 Add to pubspec.yaml

**File**: `pubspec_base.yaml`

Add the asset path:

```yaml
flutter:
  assets:
    - assets/walletx_node_list.yml
```

### 5.3 Load Nodes

**File**: `lib/entities/node_list.dart`

Add a function to load nodes:

```dart
Future<List<Node>> loadDefaultWalletXNodes() async {
  final nodesRaw = await rootBundle.loadString('assets/walletx_node_list.yml');
  final loadedNodes = loadYaml(nodesRaw) as YamlList;
  final nodes = <Node>[];
  for (final raw in loadedNodes) {
    if (raw is Map) {
      final node = Node.fromMap(Map<String, Object>.from(raw));
      node.type = WalletType.walletx;
      nodes.add(node);
    }
  }
  return nodes;
}
```

In the `resetToDefault` function, call it:

```dart
final walletxNodes = await loadDefaultWalletXNodes();
nodes.addAll(walletxNodes);
```

### 5.4 Add Default Node Migration

**File**: `lib/entities/default_settings_migration.dart`

#### 5.4.1 Define Default Node URI

At the top of the file:

```dart
const String walletXDefaultNodeUri = 'api.walletx.io';
```

#### 5.4.2 Add Helper Functions

```dart
Node? getWalletXDefaultNode({required Box<Node> nodes}) {
  return nodes.values.firstWhereOrNull((Node node) => node.uriRaw == walletXDefaultNodeUri) ??
      nodes.values.firstWhereOrNull((node) => node.type == WalletType.walletx);
}

Future<void> addWalletXNodeList({required Box<Node> nodes}) async {
  final nodeList = await loadDefaultWalletXNodes();
  for (var node in nodeList) {
    if (nodes.values.firstWhereOrNull((element) => element.uriRaw == node.uriRaw) == null) {
      await nodes.add(node);
    }
  }
}

Future<void> changeWalletXCurrentNodeToDefault({
  required SharedPreferences sharedPreferences,
  required Box<Node> nodes,
}) async {
  final node = getWalletXDefaultNode(nodes: nodes);
  final nodeId = node?.key as int? ?? 0;
  await sharedPreferences.setInt(PreferencesKey.currentWalletXNodeIdKey, nodeId);
}
```

#### 5.4.3 Add Preference Key

**File**: `lib/entities/preference_key.dart`

```dart
static const currentWalletXNodeIdKey = 'current_walletx_node_id';
```

#### 5.4.4 Add Migration Case

In `defaultSettingsMigration`, add:

```dart
case "next-number-increment": // Increment from current version
  await addWalletXNodeList(nodes: nodes);
  await changeWalletXCurrentNodeToDefault(
    sharedPreferences: sharedPreferences,
    nodes: nodes,
  );
  break;
```

#### 5.4.5 Update Migration Version

**File**: `lib/main.dart`

Increment `initialMigrationVersion` to the new case number.

### 5.5 Update Node List ViewModel

**File**: `lib/view_model/node_list/node_list_view_model.dart`

In the `reset` function, add:

```dart
case WalletType.walletx:
  node = getWalletXDefaultNode(nodes: _nodeSource)!;
  break;
```

### 5.6 Update Node Class

**File**: `cw_core/lib/node.dart`

#### 5.6.1 Update URI Getter

In the `uri` getter, add:

```dart
case WalletType.walletx:
  return useSSL ? Uri.https(uriRaw, '') : Uri.http(uriRaw, '');
```

#### 5.6.2 Update requestNode Method

Add case for `WalletType.walletx` in the `requestNode` method.

### 5.7 Update Settings Store

**File**: `lib/store/settings_store.dart`

In the `load` function:

```dart
final walletXNodeId = sharedPreferences.getInt(PreferencesKey.currentWalletXNodeIdKey);
final walletXNode = nodeSource.get(walletXNodeId);
if (walletXNode != null) {
  nodes[WalletType.walletx] = walletXNode;
}
```

Repeat in the `reload` function.

In `_saveCurrentNode`, add:

```dart
case WalletType.walletx:
  await sharedPreferences.setInt(PreferencesKey.currentWalletXNodeIdKey, node.key as int);
  break;
```

### 5.8 Run Code Generation

```bash
cd cw_core && flutter pub get && dart run build_runner build --delete-conflicting-outputs && cd ..
dart run build_runner build --delete-conflicting-outputs
```

---

## Step 6: UI Integration

### 6.1 Add Wallet Icons

**File**: `lib/src/dashboard/widgets/menu_widget.dart`

Add icon for walletx.

**File**: `lib/src/screens/wallet_list/wallet_list_page.dart`

Add icon and case in `imageFor` method:

```dart
case WalletType.walletx:
  return 'assets/images/walletx_icon.png';
```

**File**: `lib/src/screens/dashboard/desktop_widgets/desktop_wallet_selection_dropdown.dart`

Add icon similarly.

### 6.2 Update Wallet Creation

**File**: `lib/view_model/wallet_new_vm.dart`

In the `seedPhraseWordsLength` getter, add:

```dart
case WalletType.walletx:
  return 12; // or appropriate length
```

---

## Step 7: Wallet Restoration

### 7.1 Update Seed Validator

**File**: `lib/core/seed_validator.dart`

In `getWordList`, add:

```dart
case WalletType.walletx:
  return WalletXMnemonics.englishWordlist; // or appropriate wordlist
```

### 7.2 Update Restore ViewModel

**File**: `lib/view_model/wallet_restore_view_model.dart`

#### 7.2.1 Update Available Modes

In the constructor, add to appropriate restore mode lists:

```dart
case WalletType.walletx:
  availableModes = [WalletRestoreMode.seed, WalletRestoreMode.keys]; // or as appropriate
  break;
```

#### 7.2.2 Update hasRestoreFromPrivateKey

Add to the list if supported:

```dart
late final bool hasRestoreFromPrivateKey = [
  // ... existing types ...
  WalletType.walletx,
].contains(type);
```

#### 7.2.3 Update getCredentials

In the `getCredentials` method, add cases for restore modes:

```dart
case WalletType.walletx:
  if (mode == WalletRestoreMode.seed) {
    return walletx!.createWalletXRestoreWalletFromSeedCredentials(
      name: name,
      mnemonic: seed,
      password: password,
      passphrase: passphrase,
    );
  } else if (mode == WalletRestoreMode.keys) {
    return walletx!.createWalletXRestoreWalletFromPrivateKey(
      name: name,
      privateKey: options['privateKey'] as String,
      password: password,
    );
  }
  break;
```

---

## Step 8: Display Seeds/Keys

**File**: `lib/view_model/wallet_keys_view_model.dart`

In the `populateItems` function, add:

```dart
case WalletType.walletx:
  // Add items for displaying seed/keys
  break;
```

---

## Step 9: Receive Functionality

**File**: `lib/view_model/wallet_address_list/wallet_address_list_view_model.dart`

### 9.1 Create PaymentUri Implementation

```dart
class WalletXPaymentUri implements PaymentUri {
  final String address;
  final CryptoCurrency currency;
  
  WalletXPaymentUri(this.address, this.currency);
  
  @override
  String get uri => 'walletx:$address'; // Adjust scheme as needed
}
```

### 9.2 Update URI Getter

In the `uri` getter:

```dart
case WalletType.walletx:
  return WalletXPaymentUri(address, currency);
```

### 9.3 Update Address List

In the `addressList` getter, add logic to return addresses for walletx.

---

## Step 10: Balance Screen

### 10.1 Update Balance ViewModel

**File**: `lib/view_model/dashboard/balance_view_model.dart`

- Update `isHomeScreenSettingsEnabled` if needed
- Add cases to `availableBalanceLabel` and `additionalBalanceLabel` getters

### 10.2 Update Fiat Rate Updates

**File**: `lib/reactions/fiat_rate_update.dart`

In `startFiatRateUpdate`, add:

```dart
if (appStore.wallet!.type == WalletType.walletx) {
  currencies = walletx!.getWalletXTokenCurrencies(appStore.wallet!)
      .where((element) => element.enabled);
}
```

**File**: `lib/reactions/on_current_wallet_change.dart`

Similarly update `startCurrentWalletChangeReaction`.

### 10.3 Update Transaction List Item

**File**: `lib/view_model/dashboard/transaction_list_item.dart`

In `formattedFiatAmount`, add:

```dart
case WalletType.walletx:
  // Handle fiat amount conversion
  break;
```

---

## Step 11: Send Functionality

**File**: `lib/view_model/send/send_view_model.dart`

- Update `_credentials` function to handle `WalletType.walletx`
- Update `hasMultipleTokens` if walletx supports tokens

---

## Step 12: Exchange Integration

### 12.1 Update Exchange ViewModel

**File**: `lib/view_model/exchange/exchange_view_model.dart`

In `initialPairBasedOnWallet`, add:

```dart
case WalletType.walletx:
  depositCurrency = CryptoCurrency.walletx;
  break;
```

### 12.2 Update Exchange Trade ViewModel

**File**: `lib/view_model/exchange/exchange_trade_view_model.dart`

If walletx has tokens, update `_checkIfCanSend`:

```dart
bool _isWalletXToken(CryptoCurrency currency) {
  return currency is WalletXToken; // Adjust based on your token type
}

// In _checkIfCanSend:
if (_isWalletXToken(from)) {
  return true;
}
```

---

## Step 13: Home Settings (Token Management)

**File**: `lib/view_model/dashboard/home_settings_view_model.dart`

- Update `_updateTokensList` to add walletx tokens if applicable
- Update `getTokenAddressBasedOnWallet` to handle walletx tokens
- Update `getToken`, `addToken`, `deleteToken`, and `changeTokenAvailability` methods

---

## Step 14: Buy and Sell

**File**: `lib/entities/provider_types.dart`

- Add case in `getAvailableBuyProviderTypes` for `WalletType.walletx`
- Add case in `getAvailableSellProviderTypes` for `WalletType.walletx`

---

## Step 15: QR Code Restoration

### 15.1 Update QR Restore ViewModel

**File**: `lib/view_model/restore/wallet_restore_from_qr_code.dart`

Add scheme to `_walletTypeMap`:

```dart
'walletx': WalletType.walletx,
```

Update `_determineWalletRestoreMode` if needed.

**File**: `lib/view_model/restore/restore_from_qr_vm.dart`

Update `getCredentialsFromRestoredWallet` method.

### 15.2 Update Address Validator

**File**: `lib/core/address_validator.dart`

In `getAddressFromStringPattern`, add:

```dart
case WalletType.walletx:
  // Add address pattern matching logic
  break;
```

If walletx has tokens, add them to the switch case as well.

### 15.3 Update Platform Manifests

**Android**: `AndroidManifestBase.xml`

Add intent filter:

```xml
<intent-filter>
  <action android:name="android.intent.action.VIEW" />
  <category android:name="android.intent.category.DEFAULT" />
  <category android:name="android.intent.category.BROWSABLE" />
  <data android:scheme="walletx" />
</intent-filter>
```

**iOS**: `InfoBase.plist`

Add URL scheme:

```xml
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>walletx</string>
    </array>
  </dict>
</array>
```

---

## Step 16: Transaction History

**File**: `lib/view_model/transaction_details_view_model.dart`

- Add case for `WalletType.walletx` to add items to detailed view
- Update `_explorerUrl` to return blockchain explorer link
- Update `_explorerDescription` to display explorer name

---

## Step 17: Secrets Management

### 17.1 Create Secrets Config

**File**: `wallet-secrets-config.json`

Create with empty object: `{}`

### 17.2 Update Secret Key Utility

**File**: `tool/utils/secret_key.dart`

Add entry for walletx.

### 17.3 Update Generate Secrets

**File**: `tool/generate_secrets_config.dart`

Add generation logic for walletx (don't forget to call `secrets.clear()` before adding new logic).

### 17.4 Update Import Secrets

**File**: `tool/import_secrets_config.dart`

Add import logic for walletx.

### 17.5 Update .gitignore

Add:
```
**/tool/.walletx-secrets-config.json
**/cw_walletx/lib/.secrets.g.dart
```

---

## Testing Checklist

- [ ] Create a new wallet for the type
- [ ] Restore wallet from seed
- [ ] Restore wallet from private key (if supported)
- [ ] Display seed/keys correctly
- [ ] Send transaction
- [ ] Receive transaction
- [ ] View transaction history
- [ ] View transaction details
- [ ] Exchange integration (if applicable)
- [ ] Buy/Sell integration (if applicable)
- [ ] Token management (if applicable)
- [ ] QR code restoration
- [ ] Node connection and switching
- [ ] Wallet backup/restore

---

## Important Notes

1. **No Direct Imports**: Never import directly from `cw_walletx` in `lib/`. Always use the proxy layer (`lib/walletx/walletx.dart`).

2. **Proxy Pattern**: The proxy pattern ensures:
   - Conditional compilation (wallets can be excluded from builds)
   - Separation of concerns
   - Easier testing and mocking

3. **Code Generation**: Always run `build_runner` after making changes to MobX/Hive classes:
   ```bash
   dart run build_runner build --delete-conflicting-outputs
   ```

4. **EVM Wallets**: If adding an EVM-compatible wallet, use the [L2 Network Guide](./adding_new_l2_network_guide.md) instead.

5. **Token Support**: If your wallet supports tokens (like ERC20, SPL, TRC20):
   - Add token checks in `exchange_trade_view_model.dart`
   - Add token tag checks where needed
   - Implement token management in home settings

6. **Buy/Sell Providers**: Check which providers support your wallet currency and add them in `provider_types.dart`.

7. **Build Verification**: Try building a minimal version (e.g., Monero-only) to catch any missing imports or compilation errors.

---

## Common Issues

### Issue: Proxy not found

**Solution**: 
- Verify `configure.dart` is set up correctly
- Run the configuration scripts
- Check that `walletx.dart` is generated (even if empty)

### Issue: Wallet type not appearing

**Solution**:
- Verify `generateWalletTypes` includes your wallet type
- Check that configuration scripts are run
- Verify `lib/wallet_types.g.dart` includes your type

### Issue: Node connection fails

**Solution**:
- Verify node list YAML is properly formatted
- Check that nodes are loaded in `default_settings_migration.dart`
- Verify preference keys are set correctly

### Issue: Compilation errors

**Solution**:
- Ensure all proxy methods are implemented in `cw_walletx.dart`
- Check that all imports are through proxy, not direct
- Verify code generation is run

---

Copyright (C) 2018-2023 Cake Labs LLC
